<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>논문용 그래프 생성기 | Thesis Chart Maker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.plot.ly/plotly-2.25.2.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    /* 기존 스타일 유지 */
    .card { background: white; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); border: 1px solid #e5e7eb; padding: 1.25rem; }
    .nav-tab { transition: all 0.2s; cursor: pointer; border-radius: 0.5rem 0.5rem 0 0; }
    #previewArea { min-height: 500px; background-color: #ffffff; border: 1px solid #e2e8f0; }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans">
  <div class="max-w-7xl mx-auto p-4 md:p-6 lg:p-8">
    
    <!-- Header (Github 버튼 삭제됨) -->
    <header class="mb-6">
      <h1 class="text-3xl font-extrabold text-slate-800 tracking-tight">논문용 그래프 생성기</h1>
      <p class="text-sm text-slate-500 mt-1">Excel/CSV 데이터를 업로드하여 출판 품질의 그래프를 생성하세요.</p>
    </header>

    <!-- Main Grid -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      
      <!-- Left Panel -->
      <div class="md:col-span-1 flex flex-col gap-6">
        
        <!-- Tabs -->
        <div class="flex border-b border-slate-300">
          <div id="tab-upload" class="nav-tab px-4 py-2 bg-blue-600 text-white font-bold text-sm flex-1 text-center">1. 데이터 업로드</div>
          <div id="tab-edit" class="nav-tab px-4 py-2 bg-slate-200 text-slate-600 font-bold text-sm flex-1 text-center">2. 스타일 수정</div>
        </div>

        <!-- Panel 1: Upload -->
        <div id="panel-upload" class="flex flex-col gap-4">
          <div class="card">
            <h3 class="font-bold text-sm mb-2">📂 파일 불러오기</h3>
            <input type="file" id="fileInput" accept=".xlsx, .xls, .csv" class="block w-full text-xs text-slate-500 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer"/>
            <button id="btnLoad" class="mt-2 w-full py-1.5 bg-blue-600 hover:bg-blue-700 text-white font-bold text-sm rounded">데이터 로드</button>
          </div>

          <div class="card">
            <h3 class="font-bold text-sm mb-2">📊 축 데이터 설정</h3>
            <div class="space-y-2">
              <div>
                <label class="block text-xs font-bold text-slate-500">주 X축</label>
                <select id="xAxisMain" class="w-full border p-1 rounded bg-slate-50 text-xs"></select>
              </div>
              <div>
                <label class="block text-xs font-bold text-slate-500">주 Y축</label>
                <select id="yAxisMain" class="w-full border p-1 rounded bg-slate-50 text-xs"></select>
              </div>
              <div class="pt-2 border-t border-dashed">
                <label class="block text-xs font-bold text-slate-400">보조 X축 (선택)</label>
                <select id="xAxisSub" class="w-full border p-1 rounded bg-slate-50 text-xs"></select>
              </div>
              <div>
                <label class="block text-xs font-bold text-slate-400">보조 Y축 (선택)</label>
                <select id="yAxisSub" class="w-full border p-1 rounded bg-slate-50 text-xs"></select>
              </div>
            </div>
          </div>

          <div class="card flex-1">
            <h3 class="font-bold text-sm mb-2">📈 데이터 계열 선택</h3>
            <div id="columnsArea" class="space-y-1 max-h-40 overflow-y-auto pr-1">
              <p class="text-xs text-slate-400 italic">파일 로드 대기중...</p>
            </div>
            <button id="btnPlot" class="mt-3 w-full py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold text-sm rounded">그래프 그리기</button>
          </div>
        </div>

        <!-- Panel 2: Edit -->
        <div id="panel-edit" class="hidden flex flex-col gap-4">
          
          <div class="card bg-slate-100 border-slate-300">
             <div class="flex items-center justify-between mb-1">
                <h3 class="font-bold text-sm">🔄 축 교차 (Swap X-Y)</h3>
                <button id="btnSwapAxis" class="px-2 py-1 bg-slate-600 text-white text-xs rounded">OFF</button>
             </div>
             <p id="swapText" class="text-[10px] text-slate-500">현재 상태: Off</p>
          </div>

          <div class="card">
             <h3 class="font-bold text-sm mb-2">🏷️ 라벨 커스텀</h3>
             <div class="space-y-3">
               <div id="xlabels-container"></div>
               <div id="ylabels-container"></div>
             </div>
          </div>

          <div class="card">
            <h3 class="font-bold text-sm mb-2">⚙️ 옵션</h3>
            <div class="grid grid-cols-2 gap-2 text-xs">
              <label><input type="checkbox" id="xlog" /> X축 Log</label>
              <label><input type="checkbox" id="yinvert" /> Y축 반전</label>
              <label><input type="checkbox" id="gridToggle" checked /> 격자 표시</label>
              <input type="color" id="gridColor" value="#e2e8f0" class="w-full h-4">
            </div>
          </div>

          <div class="card">
             <h3 class="font-bold text-sm mb-2">🔤 차트 제목</h3>
             <input type="text" id="titleInput" class="w-full border p-1 rounded text-sm" />
          </div>

        </div>
      </div>

      <!-- Right Panel -->
      <div class="md:col-span-2 flex flex-col gap-6">
        
        <div class="relative bg-white rounded-xl shadow-sm border border-slate-200">
          <div id="previewArea" class="w-full h-full rounded-xl"></div>
        </div>

        <div class="card">
          <div class="flex flex-wrap items-center gap-4 justify-between text-sm">
             <div class="flex items-center gap-2">
               <label class="font-bold">차트 타입:</label>
               <select id="chartType" class="border p-1 rounded">
                 <option value="scatter">Scatter + Line</option>
                 <option value="bar">Bar Chart</option>
               </select>
             </div>
             <div class="flex items-center gap-2">
               <label class="font-bold"><input type="checkbox" id="legendShow" checked /> 범례 표시</label>
               <select id="legendPos" class="border p-1 rounded">
                 <option value="top right">우측 상단</option>
                 <option value="top left">좌측 상단</option>
                 <option value="bottom right">우측 하단</option>
                 <option value="bottom left">좌측 하단</option>
               </select>
             </div>
          </div>
        </div>

        <div class="card">
           <h3 class="font-bold text-sm mb-3 pb-2 border-b">🎨 계열 상세 설정 (Series Formatting)</h3>
           <div id="seriesControls" class="grid grid-cols-1 sm:grid-cols-2 gap-3">
              <p class="text-xs text-slate-400 italic py-2">계열을 선택하면 설정창이 나타납니다.</p>
           </div>
        </div>

        <div class="card bg-slate-800 text-white flex items-center justify-between gap-4 p-4">
           <div class="flex items-center gap-2 text-sm">
              <span>Size:</span>
              <input type="number" id="chartWidth" placeholder="Auto" class="w-16 p-1 rounded bg-slate-700 text-white border-none text-center" />
              <span>x</span>
              <input type="number" id="chartHeight" value="600" class="w-16 p-1 rounded bg-slate-700 text-white border-none text-center" />
           </div>
           <button id="btnUpdatePreview" class="px-6 py-2 bg-blue-600 hover:bg-blue-500 font-bold rounded text-sm">변경사항 반영</button>
        </div>

      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
